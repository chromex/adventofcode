import aoc

input = aoc.SplitEmptyLines("""##.#..###.#####
###.#.##.#..##.
###.####.#..##.
##.#..###.#####
####......#####
#.#..##.#......
##.#.....#.####
......#........
.##..#..####..#
#...####.##....
.#.###..#......
##.#.#.#.#.#..#
..##.##..##.##.

#...###.#..#...
#....#...###..#
#.##.###..###..
#########.#.##.
.#..#.##.###...
.#..#.##.###...
#########.#.##.

#....#..#....##..
#..###..###..##..
.###..##..###..##
###..#..#..######
##....##....####.
.#.#..##..#.#..#.
..###.##.###....#
#..#..##.##..##..
####.#..#.#######
.####.##.####..##
####......#######

.##.##.##
...#..#..
.#.#..#.#
#..#..#..
#.#....#.
##.#..#.#
..##..##.
..######.
.#.#..#.#
##.#..#.#
###.#..##
#.#.##.#.
.#.####.#
..#.##.#.
..#.##.#.
.#.####.#
#.#.##.#.

..###.##.
..##.##..
...#.....
##.#.###.
..##.#.##
..##.....
..#...###
###...#.#
###...#.#
..#...###
..##..#..

.....##
.#..#..
..##...
..##...
.#..#..
##..###
..##...

.########..
###.##.####
#.#....#.##
###....####
.#..##..#..
##.#..#.###
..######...
#..#..#..#.
.#.####.#..

..##....##..###
.#.##..##.#...#
.#.##..##.#...#
..##....##..#.#
##..#..#..####.
.#.##..##.#..#.
#####..#####.#.
..###..###..##.
...#.##.#....#.
#..#.##.#..#...
#..##..##..####

.#..#...##.#.#.##
#..##..##.....##.
.#.#.#.####.##.##
..##.###.....####
..##.###.....####
.#.#.#.####.##.##
#..##..##.....##.
.#..#...##.#.#.##
##..#####...#####
#.##...##..#...##
#..####.#.#.###..
#..####.#.#.###..
#.##...##..#...##
##..#####...#####
.#..#..###.#.#.##

.#.#.#.##..##.#
.###.#.##..##.#
..###..#....#..
#.......####...
.#......####...
.....##.####.##
.#..#.###..###.
#####..######..
##..###..##..##

.#..####..#......
#.#######..##..##
.##.####.##......
#..##..##..#....#
.#..####..#.####.
..##.##.##.......
#..##..##..#....#

..#...###..##
..##....##...
#.#.#....####
##.###.#.##.#
##.###.#.##.#
#.#.#....####
.###....##...
..#...###..##
..#...###..##
.###....##...
#.#.#....####

#....#.
....#.#
...#...
...#...
....#.#
#....#.
##.#.#.
#.#.###
#.####.
#.#.#..
#.#.#..
#.####.
#.#.##.
##.#.#.
#....#.
....#.#
...#...

#.##..##.##.##.
.########..####
.#..##..#..#..#
.#..##..#..#..#
...#..#......#.
###.##.######.#
#.##..##.##.##.
#.##..##.##.##.
.###..###..###.
.########..####
.##....##..##..
####..########.
##.#.##.####.##

###..##
##.##.#
###.##.
.#.##.#
..##.#.
##.#..#
...#.#.
##.#...
###....
##..#..
#####.#
..#.#.#
..#.#.#

.##..#.##
.#..#.###
####.#.#.
#..###...
####.#...
....#.#..
.##.##.##
......##.
#####...#
.....#..#
.##.....#
.##...#..
#..###...
....#.##.
....#.##.
#..###...
.##...#..

####..#...#
###..#.##..
##.####..#.
...##.##...
##.#..##.#.
....##..##.
##..#......
..###.###..
..#.#####..
..#.##.##..
..###.###..
##..#......
....##..##.
##.#..##.#.
...##.##...
##.####..#.
###..#.##..

#.#.###..###.#.##
######....#######
.####.#..#.####..
#..###....###..##
#.#..........#.##
#.##.#.##.#.##.##
..##...##...##...
..####....####...
..#.##.##.##.#...
.#.##..##..##.#..
.#..#.####.#..#.#

...###....##.##
###.......##..#
##.#....##..#..
.#.####.#.##.##
#.##..##.....##
##.###....#.#.#
#..###....#.#.#
#.##..##.....##
.#.####.#.##.##
##.#....##..#..
###.......##..#
...###....##.##
.#.##..#....##.
#......##...##.
###..###...####
###..###...####
#......##...##.

..#..#...
#.####.##
.##..##..
#......##
#.#..#.##
##.##..##
..####...

.#..#..###.####.#
.#..#.##..#.##...
.####...#.#....#.
#....#...#..##..#
..##..##.........
##..#####........
#######..###..###

.##.#.#..
.##.###..
.......##
##.##.#..
.###.##..
#####..##
#.#..#...
##.######
.#.##.###

#.##.##.##.##.##.
..#.#..#.#....#.#
#..#....#..##..#.
#..##..##..##..##
####....########.
.####..####..####
..#.#..###....###

.#.##.#......
########..##.
.#.##.#.##..#
.######.##..#
##....##.....
.#.##.#..#..#
.######.##..#
#.#..#.#.####
#......#.....
...##...#....
.#....#......
..#..#...####
###..####.##.
.######.#....
..#.##..#....
.#.##.#.#.##.
#.#..#.###..#

#.#..#####.##.#
#.#.###.#######
...####...####.
...##.##..####.
#...#.#.#.#..#.
##..#...#.#..#.
##..#...#.#..#.
#...#.#.#.#..#.
...##.##..####.
...####...####.
#.#.###.#######
###..#####.##.#
####.##.##....#

#..#..#
.##.##.
..#.##.
###....
..#####
..#####
###....
..#.##.
.##.##.
#.##..#
.#.....
....##.
.#.....
####..#
.##....
.#.....
#.#.##.

###.####.
###.####.
#........
.###...#.
.######..
..#.#...#
..#.#...#
.######..
..##...#.

...#...
...##..
.#.#.##
....###
....##.
.....#.
.....#.
....##.
....###
.#.#.##
...##..
...#...
#.#.#..
#..##.#
.##.##.

....##.####..
.#..##.####..
..###.###..##
..##...###.##
#.##.#.#.#.##
.##...####...
..#.#...#...#
..#.#...#...#
.##...####...

#..##..
#..##..
##...##
..#...#
..#.##.
..#.##.
..#...#
##.#.##
#..##..

.....#.##.#....
.#.#...##...#.#
###.#.#..#.#.##
#.###......###.
.###...##...###
####.######.###
##..#..##..#..#
.#..#..##..#..#
#.#..######..#.
#.##..####..##.
###.#......#.##
##...######...#
.#...######...#
###.#......#.##
#.##..####..##.

###........
.####.##.##
.##...##...
.##...##...
.####.##.##
###........
.#......#..
..#..####..
..#.##..##.
#.##......#
.#####..###
..###.##.##
###.##..##.
..#...##...
#.###....##

##.....##.....#
####........###
..############.
..##...##...##.
..##.#....#.###
..#.#..##..#.#.
..##...##...##.
###.##....##.##
....##....##...
..#.###..###.#.
##.##..##..##.#
..#.##.##.##.#.
###..######..##
##.#.##..##.#.#
##.##########.#
####.#....#.###
#######..######

#.#.#...#..
#.#.#...#..
..###.#..#.
#.#.####...
##.###..###
.#.#.#.##.#
.##..#...#.
###.....#.#
##..#..##..
.#####...##
....#...#.#
....#...#.#
.#####..###

....#.#..#..#..
....####..##..#
....#...######.
####....#....#.
##..#..########
......#.#.##.#.
..##.###.#..#.#
..#.....#....#.
##..#.##....#.#

#......#...
##.##.###.#
..........#
###..#####.
########.#.
.#.##.##..#
..#..#....#
.##..##...#
#.####.#.##
#.####.#.##
.##..##...#

###.###.#....
..#####.##...
###..#.#.#..#
..#....#....#
..##...#....#
###..#.#.#..#
..#####.##...
###.###.#....
...##...#....
...#..#...##.
....##.....##
...#..#..#..#
###..###.#.#.
###.####..##.
##.#.#.#.###.

.##..#..##..#.#
..##....#.#..#.
..##....#.#..#.
.....#...#..#..
.##..##.###.###
.##..##.###.###
.....#...#..#..
..##....#.#..#.
..##....#.#..##
.##..#..##..#.#
#.#.#.#########
...#.#.#.#...##
...#.#.#.#...##

#.#...#..#.
..#.#..##..
##..#.####.
.####.####.
.##..#.##.#
###..#.##.#
.####.####.
##..#.####.
..#.#..##..
#.#...#..#.
###.##....#
##.#.#.##.#
.#.###....#
.#.##.####.
..#####..##
.#..##.##.#
.....##..##

##......#.#....#.
##.#...#.#..#.##.
...##.##.#.#.##.#
..#.####..###....
##.#....#.###.#.#
##.#..####..#.#..
####...##.##.####
##....#..#.....##
##....#..#.....##
####...#..##.####
##.#..####..#.#..
##.#....#.###.#.#
..#.####..###....
...##.##.#.#.##.#
##.#...#.#..#.##.

#..##.#......#.##
#####.#.####.#.##
#..###..###...###
.##..#.#.##.#.#..
#######.####.####
####.##......##.#
.........##......
....###..##..###.
.##.#.##.##.##.#.
......##....##...
#..##.########.##
.....#........#..
#######......####
....#.#......#.#.
#..##....##....##

###.##.##
###...##.
###...##.
###.##.##
...######
.##.###..
##...##.#
..##.....
##.####.#

######.....
..###..#..#
#.#........
####.......
#.##.#..#.#
..#####.#..
###...#...#
..#.##..##.
..#...#...#
..#.#.##...
##.#.#.##..
#.#.#.#####
#...#.#####
..#..#.##.#
..#..#.##.#
#...#.#####
#.#.#.#####

##.#.###.##...#.#
..#.#.###.....#.#
..#.#.###.....#.#
##.#.###.##.....#
##..##.#..#..#...
..#.##..##.#.#.##
##......##.#...##
##.###.....#...##
####.####..#.....
...###.#.##...#..
..#.#.#.#..#.##.#
...##..#....#.###
....#.#..#.#####.

#..#..#...###
.##..#.#.##..
.#.##.#####.#
#.##.##.##.##
#....#..##...
#....#..##...
#.##.##.##.##

#.##.##...#.#
#..#......###
#..#......###
#.##.##...#.#
#.#..#....#..
.##.#.####.##
.#.#.....###.
..#...#.##..#
####...##...#
.#..##.##..#.
.####.##...#.
.####.##...#.
.#..##.##..#.
####...##...#
..#...#.##..#
##.#.....###.
.##.#.####.##

..####.
#..####
..#....
..#....
#..####
..####.
.##...#
..####.
..####.
.##...#
..#####
#..####
..#....

##....##.##....
#.#.#.##....#.#
#.#.#.##....#.#
#.....##.##....
.#.####..##.#.#
####.###..#.#..
####.#...#.####
##.....##...###
.#..#.##....###
.#..#.##....###
##.....##...###

#######.##.##
##...#......#
..#.##.####.#
...#....##...
#####..###...
....##.#..#.#
...####....##
######......#
##.#.#..##..#
..##...#..#..
..#...##..##.

#####..##
##.#....#
...######
....#..#.
###.#..#.
#....##..
..#.####.
..#.#..#.
##.##..##
..###..##
.....##..

##....##..#.###
..#.##......##.
...##...##.#..#
.######..###.#.
.#....#..#.#...
.#....#..#.#...
.######..###.#.

##.#...
####...
..#.###
##.##.#
####...
..##.#.
###..#.
....#.#
####.#.
##.#.#.
##..###

.###..#######.###
....##.##.###....
#...#.##.###.....
#.#.###.....#####
...###..##.#.##..
......#...#..##..
......#...#..##..
...###..##.#.##..
#.#.###....######
#...#.##.###.....
....##.##.###....

#.##.#.##...#
..##.....###.
..##.....###.
#.##.#.##...#
...###...#..#
##.##.#.#####
.##.###...##.
###.####.###.
###.####.#.#.
.##.###...##.
##.##.#.#####

....#......#..###
..#.##....##.##.#
#..#..#.##....#..
.##..#.#..##.#...
#..#..#.#...#....
....#...#####.#..
####.#.##.#.####.
####.#.##.#.####.
....#...#####.#..

.#.##.###..##..
#####..########
##.##..#..#####
##.##..#..#####
######.########
.#.##.###..##..
...#.##.#.###..
.##...#......##
#..##....#.##..

######...#.#.
######...#.#.
##..##..##.#.
.###.#.##...#
.##.....##.#.
#..###..###.#
..#.###.#..#.
..#.###..####
..#.###.#####

.#...#.##.#....
.##..#.##.#....
##...#..####.#.
.#..#...######.
.......####..##
...#......#####
#...##.######..
###.###..#.#..#
####.##.###.#.#
.##.###.#..#..#
#.#.#...##....#
##.....##.####.
##.....##.####.
#.#.#...##....#
.##.###.#..#..#
####.##.###.#.#
###.###..#.#..#

..##.##
##..###
##.#.#.
...###.
..#.##.
..#.###
###....
##.####
....###
..##..#
..##..#
....###
##..###
###....
..#.###

..#####
##.##..
..##...
..##...
##.##..
..#####
#.#..#.
#.#..#.
..#####
##.##..
..##.#.

....#..
#..##.#
.##.#..
.##..#.
####...
#..###.
#..##..
##.#...
.##..#.
.##.###
#####..
#####.#
####...
.##..##
.##..##
####...
#####.#

.####..#.
#...#.##.
##.#####.
##.#####.
#...#.##.
.####..#.
####.#...
...####..
.#...##..
.##...#.#
#......##
###..####
#..##....
##.#....#
##......#

....##....##.
#..#.#.##.#.#
#####.####.##
....#..##..#.
#..#........#
#..##.......#
....##.##.##.
....########.
#..#..#..#..#
#..#.#.##.#.#
#..####..####
....##....##.
....#.#..#.#.
#..##########
.##.########.
####..#..#..#
.##..######..

....##..#.#.###
.#.##.####.#.##
.##.##..##.##.#
####.####.#..#.
####.#.#.#.#.#.
.#.....####.##.
.#.....####.##.
####...#.#.#.#.
####.####.#..#.
.##.##..##.##.#
.#.##.####.#.##
....##..#.#.###
....##..#.#.###

#........##
.#.#..#.#..
###.....##.
#..####..##
#...##...#.
..##..##...
..##..##...

###..##...#..##.#
###..##.#.#..##.#
###..##.#.#..##.#
###..##...#..##.#
##.##.##..##.#..#
#.##.##..#####.#.
..#..#.##...#...#
#...##..##.#....#
#......###.#.####

.#...#..##..###
.#...#..##..###
#...##..#...##.
.#..#...#......
..###.##..#.#..
#########..##..
##....#...##.##
.#....#.######.
.##..#..#.#....
.##.....#.#....
.#....#.######.
##....#...##.##
#########..##..

.###.###...
####.###...
.##...###.#
.######.#.#
.#..#..##..
###.##.###.
.#....##.#.
##.#.#....#
#.#..#..##.
.#.#..##..#
.#.#.#.##.#
###.#..##.#
###.#..##.#
.#.#.#.##.#
.#.#..##..#
#.#..#..##.
##.#.#....#

.#.##....
.##.##...
.###.#...
.##...###
......###
..#...###
.##...###
.###.#...
.##.##...
.#.##....
.########
##.#..###
##...####

#.###..
#....#.
.....#.
.#.#.##
.#.#.##
.....#.
#....#.

...##.#.#..#.##
....#..#..####.
#.#.##...##....
##.##.......##.
.##.#..#..##..#
.##.#..#..##..#
##.##.......##.
#.#.##...##....
.......#..####.
...##.#.#..#.##
...##.#.#..#.##

######.....
##..##.#..#
##..##.##..
#######.#.#
......##..#
######..###
..##..#.##.
.#..#.#...#
......####.
##..##.####
#....#..###
#....#...##
##..##.####

##.#..#..
#.....##.
#.#.#.##.
.####.##.
...#.....
..##.####
..##.####
...#.....
.####.##.
#.#.#.##.
#.....##.

#.#####
####...
#.#####
#.#.###
..###..
.###.##
#.#..##
.##....
.###.##
.##.###
#..#...
#...##.
##..###
...#.##
...#.##

...#..##.#.##.#
#..#.#..#......
.#.##.##.##..##
##..##.#.##..##
#.#.#..#..####.
.#.#..####..#.#
#.#...#.#.#..#.
.#.....###....#
.##.##.###....#
.##.#.....#..#.
.#.#.#####....#
####.#...#.##.#
..##.......##..
...#.######..##
...#.######..##

.##.###.####.
.....###.....
....#..##.##.
....#..##.##.
.....###.....
.##.###.####.
#.##..##.#..#

#..##......##..
######.........
#######........
#..##......##..
#..##.###.....#
####....###...#
.##.##.####....
....#####...##.
....#...###....
#..##.#...##...
######...#.##.#

##.##......#.
..#.##.....#.
###.#..######
..##.###.#.#.
...######..##
...######..##
...#.###.#.#.
###.#..######
..#.##.....#.
##.##......#.
..#.......#..
##....#......
##.#.#.#.....
####.###..###
..###..#.###.

#####..
..###..
.#.##..
#...###
####...
.##.#..
####.##
#...###
.....##
.##.###
#...###
###.#..
.#..###
.#..###
##..#..

....########.....
#..##..##..##..##
#...###..###...##
#..#........#..##
##.##.####.##.###
..##.#....#.##...
#.#.###..###.#.##
#..###....###..##
#.###.#..#.######
#####......######
.......##........
#..#.#....#.#..##
##..#.#..#.#..###
###.##.##.##.####
.#..#.####.#..#..

....##.
.#.#..#
...#..#
##.#..#
....##.
...#..#
..#....
#..####
#..####
.##....
...#..#
....##.
##.#..#

.....#..#....
####..####..#
.##.#########
#..#.#..#...#
.....###.####
.##...#...##.
#####.#.#.##.
.##.##.##.##.
####..#......
####.#.##....
......#..#..#
....#.#.#####
........#.##.

.##.###.....###..
.##.###.....###..
#..##.#.#.#.##.#.
####.##.#.#..#.#.
.##....#..#####..
#..#..#.######.#.
....#.##..###..#.
####..#.#.......#
####.#.##..#.##..
.###.####...#....
.##....####......
.....###..#.##.##
.##.#.#..#.#####.
#..#..#.##...#.##
#..#.#...##.###.#
.##.#..##..#.##..
#..###...##.###.#

##......##..#..
.#...#..##.##..
#.##...#####...
#.##...#####...
.#...#..##.##..
##......##..#..
.#.###.#..#.#.#
#.#...#...#.##.
#.#...#...#.##.
.#.###.#..#.#.#
##......##.....

..#.####.#..#..
###.#.##...####
##.#...#...#.##
#...#.####.....
#...#.###......
##.#...#...#.##
###.#.##...####
####..###...###
##.####..##..#.
##.####..##..#.
####..###...###
###.#.##...####
##.#...#...#.##
#...#.###......
#...#.####.....
##.#...#...#.##
###.#.##...####

.##.#.##..#.###
.##.#..#.#####.
#..##....#..##.
####..#...##...
.##...#.###.##.
#..#.####.#..#.
#..##..##.#.##.
#..##..##.#.##.
#..#.####.#..#.
.##...#.#.#.##.
####..#...##...

..#...#..##..
####..#.####.
..##.#.......
#######.#..#.
#...#..##..##
#.##.####..##
##.#..#..##..
##.#..#..##..
#.##.####..##
#...#..##..##
###.###.#..#.

.#.#.##.#
.#.#.##..
##..#....
#.#..#..#
.###....#
.##..##..
####.#..#
#....##..
##..###..
#....#.##
####.##..
....#.###
#.#..####
#..#.....
#..#.....

...#....#.#.#
...#....#.#.#
..#.#.#..##..
###.#.....##.
###...#.#..#.
###..##.###..
##.###.##...#
##.####..##..
...#.###.###.
..#.#.####...
.#.####.#....
..#..###.#...
...#####.....

######...##
###.##.###.
##.##..#.#.
##.##..#.#.
###.##.###.
####.#...##
.....###...

..##.#...##
..#..##..#.
#..#####...
..#..#.#.#.
#...#.###..
.#....#.##.
##..#.#####
...#.#...#.
...#.#.....
##..#.#####
.#....#.##.
#...#.###..
..#..#.#.#.
#..#####...
..#..##..#.
..##.#...##
..##.#...##

....###
..##.##
##...##
##.#.#.
....#..
..####.
..##.#.
....#..
##.#.#.
##...##
..##.##
....###
....##.
.#....#
.##.##.
.##.##.
.#....#

....########...
##..#..##..#..#
#####......####
..##.#.##.#.##.
..#.#..##..#.#.
###.########.##
##..#.######..#
##..#......#..#
..##........##.
##.####..####.#
###.###..###.##
####.#.##.#.###
###..........##
####..#..#..###
##.###.##.###.#

..##..##.
####..###
###....##
...####..
########.
....##...
...#..#..
....##...
###.##.##
##.####.#
..#.##.#.
...####..
....##...
..######.
..#....#.

....##.##
....##.##
.####....
#..#.##..
##.##...#
#####.#..
..####..#
..#....##
........#
........#
..#....#.

....##.......##
###.##...#.#.#.
###.#..#..####.
####..#.......#
###.##..#..#.#.
###..#.##.#.###
..#.#..##.###..
##.#####..#####
###.###...#.#.#
..###.##...##.#
..#....###..##.
#####.#....#..#
##.#...######..
##.#...######..
#####.#..#.#..#

.#..#.##.##
#.#......#.
...#.###.##
...#.###.##
#.#......#.
.#..#.##.##
#####.##.##
....#####..
###...#..##
#.#..##..#.
.#.######.#
##.##.####.
#.#####..##
##.####.###
##..#.#.##.
##....#.##.
##.####.###

..####..#..
###..####..
##....##.##
.##..##.###
#.#..#.####
###.#######
#......##..
#.####.####
##.##.##...
##....##...
#.####.####

##..#.######..##.
.###..##...#.#..#
#.#..#..##.#..#.#
####.#..###..##..
......##.########
......##.###.####
####.#..###..##..
#.#..#..##.#..#.#
.###..##...#.#..#
##..#.######..##.
##..#.######..##.

#....####.##.####
.##.###...##...##
#..#....######...
#####..#.####.#..
.##.#..#.#..#.#..
#..###.##....##.#
#..##...#.##.#...
#..#...###..###..
.##.#..#.#..#.#..
.##.##....##....#
#..##.###....###.""")

def GetRow(map, idx): return map[idx]
def GetCol(map, idx): return map.GetColumn(idx)

def Check(map, maxIdx, access, multiplier, skip=-1):
    for idx in range(maxIdx - 1):
        if access(map, idx) == access(map, idx + 1):
            left = idx - 1
            right = idx + 2

            while left >= 0 and right < maxIdx and access(map, left) == access(map, right):
                left -= 1
                right += 1
            
            if left < 0 or right >= maxIdx:
                #print(f"Found: {idx + 1}")
                val = (idx + 1) * multiplier
                if val != skip:
                    return val
            
    return 0

def FixSmudge(map: aoc.DataMatrix, og):
    for y in range(map.Height):
        for x in range(map.Width):
            v = map[x, y]
            if v == "#":
                map.Set(x, y, ".")
            else:
                map.Set(x, y, "#")
            val = Check(map, map.Width, GetCol, 1, og) + Check(map, map.Height, GetRow, 100, og) 
            if val > 0:
                return val
            map.Set(x, y, v)
    print("ERROR")

def GetOG(map):
    return Check(map, map.Width, GetCol, 1) + Check(map, map.Height, GetRow, 100)

sum = 0
for entry in input:
    map = aoc.DataMatrix(entry)

    print(map)
    print()

    og = GetOG(map)
    sum += FixSmudge(map, og)

print(sum)