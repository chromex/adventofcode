import aoc, sys

inp = """#############################################################################################################################################
#...#...........#...#.......###...#...#.....#...#...#...###.......#...#.........#...#...#.........###...#...###.....#...#.....###...#...#...#
#.#.#.#########.#.#.#.#####.###.#.#.#.#.###.#.#.#.#.#.#.###.#####.#.#.#.#######.#.#.#.#.#.#######.###.#.#.#.###.###.#.#.#.###.###.#.#.#.#.#.#
#.#.#.........#.#.#.#.....#.#...#...#...#...#.#.#.#.#.#...#.#.....#.#.#.#.......#.#...#...#.......#...#.#.#...#.#...#.#.#.#...#...#...#.#.#.#
#.#.#########.#.#.#.#####.#.#.###########.###.#.#.#.#.###.#.#.#####.#.#.#.#######.#########.#######.###.#.###.#.#.###.#.#.#.###.#######.#.#.#
#.#...###...#.#.#.#...###.#.#.........#...#...#.#.#...#...#.#.....#.#.#.#.....###.......#...#...#...#...#.#...#.#...#.#...#.#...#.......#.#.#
#.###.###.#.#.#.#.###.###.#.#########.#.###.###.#.#####.###.#####.#.#.#.#####.#########.#.###.#.#.###.###.#.###.###.#.#####.#.###.#######.#.#
#...#...#.#.#.#.#.#...#...#.....###...#.#...#...#.....#.....#...#.#.#.#...#...#...###...#...#.#.#...#...#.#.###...#...#.....#...#...#...#.#.#
###.###.#.#.#.#.#.#.###.#######.###.###.#.###.#######.#######.#.#.#.#.###.#.###.#.###.#####.#.#.###.###.#.#.#####.#####.#######.###.#.#.#.#.#
###...#...#.#.#.#.#...#.....#...#...#...#...#...#.....#.......#...#.#.###.#...#.#...#.#...#.#.#.###.#...#.#.....#.....#.....###...#...#...#.#
#####.#####.#.#.#.###.#####.#.###.###.#####.###.#.#####.###########.#.###.###.#.###.#.#.#.#.#.#.###.#.###.#####.#####.#####.#####.#########.#
#...#.....#.#.#.#...#.......#.....#...###...#...#.#...#...#.....#...#.#...#...#.#...#...#.#.#.#.#...#...#.#.....###...#.....#...#...#.......#
#.#.#####.#.#.#.###.###############.#####.###.###.#.#.###.#.###.#.###.#.###.###.#.#######.#.#.#.#.#####.#.#.#######.###.#####.#.###.#.#######
#.#.......#...#...#...............#.....#.#...###...#.#...#.#...#...#.#...#.#...#.#...#...#.#.#...#.....#.#...#...#.#...#...#.#...#.#.#...###
#.###############.###############.#####.#.#.#########.#.###.#.#####.#.###.#.#.###.#.#.#.###.#.#####.#####.###.#.#.#.#.###.#.#.###.#.#.#.#.###
#.#...#...#.....#...#...#...#...#.....#...#.....###...#.....#.#...#.#...#.#.#...#.#.#.#.#...#.....#.....#...#.#.#...#.#...#.#...#...#...#...#
#.#.#.#.#.#.###.###.#.#.#.#.#.#.#####.#########.###.#########.#.#.#.###.#.#.###.#.#.#.#.#.#######.#####.###.#.#.#####.#.###.###.###########.#
#...#.#.#...###...#...#...#.#.#.#...#.....#.....#...#...#...#.#.#.#.#...#.#.#...#.#.#...#...#.....#...#...#.#...#.....#.#...#...#.....#...#.#
#####.#.#########.#########.#.#.#.#.#####.#.#####.###.#.#.#.#.#.#.#.#.###.#.#.###.#.#######.#.#####.#.###.#.#####.#####.#.###.###.###.#.#.#.#
#.....#...#...###.#.......#...#.#.#.#...#.#...###...#.#.#.#.#.#.#.#.#.#...#...#...#.#...#...#...#...#...#.#.#...#.#...#.#.###...#...#.#.#.#.#
#.#######.#.#.###.#.#####.#####.#.#.#.#.#.###.#####.#.#.#.#.#.#.#.#.#.#.#######.###.#.#.#.#####.#.#####.#.#.#.#.#.#.#.#.#.#####.###.#.#.#.#.#
#.........#.#.#...#.#.....#...#...#...#.#...#.#...#.#.#...#...#.#.#.#.#.#.....#.###...#.#.#...#.#.#...#.#.#.#.#...#.#...#...#...#...#.#.#...#
###########.#.#.###.#.#####.#.#########.###.#.#.#.#.#.#########.#.#.#.#.#.###.#.#######.#.#.#.#.#.#.#.#.#.#.#.#####.#######.#.###.###.#.#####
#...........#...#...#.......#...#.....#...#.#.#.#.#.#...#...#...#.#.#.#.#.###...#...#...#...#...#.#.#.#...#.#.#...#...#.....#.#...###...#...#
#.###############.#############.#.###.###.#.#.#.#.#.###.#.#.#.###.#.#.#.#.#######.#.#.###########.#.#.#####.#.#.#.###.#.#####.#.#########.#.#
#.#.....#.........#####...#...#...###...#...#.#.#...#...#.#.#...#.#.#...#.....###.#.#...........#.#.#...#...#.#.#.....#.#...#.#.#.....#...#.#
#.#.###.#.#############.#.#.#.#########.#####.#.#####.###.#.###.#.#.#########.###.#.###########.#.#.###.#.###.#.#######.#.#.#.#.#.###.#.###.#
#.#.#...#.#.........#...#.#.#.#...#...#.....#...#.....###.#.#...#.#...#.......#...#...#.......#.#...#...#...#...#.......#.#.#.#.#...#.#.#...#
#.#.#.###.#.#######.#.###.#.#.#.#.#.#.#####.#####.#######.#.#.###.###.#.#######.#####.#.#####.#.#####.#####.#####.#######.#.#.#.###.#.#.#.###
#...#...#.#.......#.#...#...#.#.#...#.#...#.#.....###...#.#.#.#...#...#...#...#...#...#.#.....#...#...#.....#...#...#.....#...#.....#...#...#
#######.#.#######.#.###.#####.#.#####.#.#.#.#.#######.#.#.#.#.#.###.#####.#.#.###.#.###.#.#######.#.###.#####.#.###.#.#####################.#
###...#...#...#...#.###.....#.#.....#.#.#.#.#...#...#.#.#.#.#.#.#...#...#.#.#...#.#...#.#...#...#.#.#...#.....#.....#...#.......#.....#.....#
###.#.#####.#.#.###.#######.#.#####.#.#.#.#.###.#.#.#.#.#.#.#.#.#.###.#.#.#.###.#.###.#.###.#.#.#.#.#.###.#############.#.#####.#.###.#.#####
#...#.#...#.#.#...#.#...#...#.......#.#.#.#...#.#.#.#.#.#.#.#.#.#...#.#...#...#.#.#...#.#...#.#.#.#.#.#...#...#...###...#.....#...###.#.....#
#.###.#.#.#.#.###.#.#.#.#.###########.#.#.###.#.#.#.#.#.#.#.#.#.###.#.#######.#.#.#.###.#.###.#.#.#.#.#.###.#.#.#.###.#######.#######.#####.#
#...#...#...#.....#...#...#.........#.#.#...#.#...#.#.#.#.#.#.#.....#...#...#.#.#.#...#.#.#...#.#.#...#...#.#.#.#.....#.....#.......#.....#.#
###.#######################.#######.#.#.###.#.#####.#.#.#.#.#.#########.#.#.#.#.#.###.#.#.#.###.#.#######.#.#.#.#######.###.#######.#####.#.#
#...#.....................#.#.....#.#.#...#...###...#.#.#.#.#.....#.....#.#.#.#.#...#...#.#.#...#.###...#...#...#.....#...#.........#...#...#
#.###.###################.#.#.###.#.#.###.#######.###.#.#.#.#####.#.#####.#.#.#.###.#####.#.#.###.###.#.#########.###.###.###########.#.#####
#.....#...###...#...#...#...#...#...#.....###...#.#...#.#.#.#.....#.....#.#.#.#.#...#.....#.#...#.#...#...........###.....#...#...#...#.#...#
#######.#.###.#.#.#.#.#.#######.#############.#.#.#.###.#.#.#.#########.#.#.#.#.#.###.#####.###.#.#.#######################.#.#.#.#.###.#.#.#
#.....#.#.#...#...#...#.........#...........#.#...#.#...#.#.#.....#.....#.#.#.#.#.#...#...#...#.#.#.#.....#...###...###.....#...#.#.#...#.#.#
#.###.#.#.#.#####################.#########.#.#####.#.###.#.#####.#.#####.#.#.#.#.#.###.#.###.#.#.#.#.###.#.#.###.#.###.#########.#.#.###.#.#
#...#.#.#.#.......#...#...#...#...#.........#.......#.#...#.#...#.#...#...#.#.#.#.#.....#.#...#...#.#.#...#.#...#.#...#...#.....#...#...#.#.#
###.#.#.#.#######.#.#.#.#.#.#.#.###.#################.#.###.#.#.#.###.#.###.#.#.#.#######.#.#######.#.#.###.###.#.###.###.#.###.#######.#.#.#
#...#...#.#.....#...#...#...#...###.................#.#...#.#.#...#...#.#...#.#...###.....#.###...#...#.....#...#...#.###.#...#.#.......#.#.#
#.#######.#.###.###################################.#.###.#.#.#####.###.#.###.#######.#####.###.#.###########.#####.#.###.###.#.#.#######.#.#
#.......#.#...#...............................#...#.#...#.#.#...###...#.#...#.###.....#...#.#...#.............#.....#.....#...#.#.........#.#
#######.#.###.###############################.#.#.#.###.#.#.###.#####.#.###.#.###.#####.#.#.#.#################.###########.###.###########.#
#.......#.###.................#.............#.#.#...###.#.#.#...#.....#...#.#...#.#...#.#.#.#.....#.......#...#.#...........#...#.........#.#
#.#######.###################.#.###########.#.#.#######.#.#.#.###.#######.#.###.#.#.#.#.#.#.#####.#.#####.#.#.#.#.###########.###.#######.#.#
#.......#.#...#...#...###.....#.#...........#.#.###...#...#...###.......#.#.#...#.#.#.#.#.#...#...#.....#...#...#...........#...#.......#...#
#######.#.#.#.#.#.#.#.###.#####.#.###########.#.###.#.#################.#.#.#.###.#.#.#.#.###.#.#######.###################.###.#######.#####
#.......#.#.#.#.#.#.#.#...#...#.#...#.......#.#.....#...............#...#.#.#...#...#.#.#.#...#.........#...#...#...#.....#...#.#.....#.....#
#.#######.#.#.#.#.#.#.#.###.#.#.###.#.#####.#.#####################.#.###.#.###.#####.#.#.#.#############.#.#.#.#.#.#.###.###.#.#.###.#####.#
#.......#.#.#.#.#.#.#.#.....#...###...#.....#.....#.....#.....#...#.#.#...#...#...###...#...#.............#.#.#...#...###.#...#...###.#...#.#
#######.#.#.#.#.#.#.#.#################.#########.#.###.#.###.#.#.#.#.#.#####.###.###########.#############.#.###########.#.#########.#.#.#.#
#...#...#...#...#...#...#...###.........#.......#...#...#...#.#.#.#.#...#####.#...#...#...#...#...#.......#...#.........#...#...#...#...#.#.#
#.#.#.#################.#.#.###.#########.#####.#####.#####.#.#.#.#.#########.#.###.#.#.#.#.###.#.#.#####.#####.#######.#####.#.#.#.#####.#.#
#.#.#.......#.....#...#...#...#...........#...#.....#.....#.#...#...###...#...#...#.#...#...#...#.#.#.....#.....#.....#.......#...#...###...#
#.#.#######.#.###.#.#.#######.#############.#.#####.#####.#.###########.#.#.#####.#.#########.###.#.#.#####.#####.###.###############.#######
#.#.........#...#...#.......#.#...#.....#...#.#.....#...#.#.....#.......#.#...#...#.......#...#...#.#.......#.....#...#...#...........#...###
#.#############.###########.#.#.#.#.###.#.###.#.#####.#.#.#####.#.#######.###.#.#########.#.###.###.#########.#####.###.#.#.###########.#.###
#...#...........#...........#...#...###...###...#...#.#.#.......#...#...#.....#.#...#...#...###.....#.........#...#.....#...#...###...#.#...#
###.#.###########.###############################.#.#.#.###########.#.#.#######.#.#.#.#.#############.#########.#.###########.#.###.#.#.###.#
###...#.........#.............#.............#...#.#...#...........#.#.#.......#.#.#...#...#...#...###.....#.....#.............#...#.#.#.#...#
#######.#######.#############.#.###########.#.#.#.###############.#.#.#######.#.#.#######.#.#.#.#.#######.#.#####################.#.#.#.#.###
#.....#.....#...#.............#.#...........#.#.#.#.........#...#.#.#.#.......#.#.#.....#...#...#.......#...#...#...#.............#.#.#.#.###
#.###.#####.#.###.#############.#.###########.#.#.#.#######.#.#.#.#.#.#.#######.#.#.###.###############.#####.#.#.#.#.#############.#.#.#.###
#...#.#.....#.....#.........#...#...#...#...#.#.#.#...#...#...#.#.#.#.#.#.....#.#...#...#...#...#.....#.......#...#.#.#...#...###...#...#...#
###.#.#.###########.#######.#.#####.#.#.#.#.#.#.#.###.#.#.#####.#.#.#.#.#.###.#.#####.###.#.#.#.#.###.#############.#.#.#.#.#.###.#########.#
#...#...#.......#...###...#...#...#...#...#...#.#.#...#.#.....#.#.#.#.#...#...#.#...#.....#...#.#.###.............#...#.#.#.#.....#.....#...#
#.#######.#####.#.#####.#.#####.#.#############.#.#.###.#####.#.#.#.#.#####.###.#.#.###########.#.###############.#####.#.#.#######.###.#.###
#.#.....#...#...#.#.....#.......#.#...#...#...#...#.....#.....#.#.#...#...#...#.#.#.........#...#.#.........#.....#...#.#...#...#...#...#...#
#.#.###.###.#.###.#.#############.#.#.#.#.#.#.###########.#####.#.#####.#.###.#.#.#########.#.###.#.#######.#.#####.#.#.#####.#.#.###.#####.#
#.#...#.....#...#.#...#...#.....#...#...#...#.#...#.......#...#...#...#.#.###...#...#.....#...#...#.......#...#...#.#.#.#.....#.#...#.#...#.#
#.###.#########.#.###.#.#.#.###.#############.#.#.#.#######.#.#####.#.#.#.#########.#.###.#####.#########.#####.#.#.#.#.#.#####.###.#.#.#.#.#
#.#...#.......#.#.###...#.#.#...#...........#...#.#.........#...#...#.#.#.....#...#.#.#...#...#.#...#...#.......#...#...#.....#.....#...#...#
#.#.###.#####.#.#.#######.#.#.###.#########.#####.#############.#.###.#.#####.#.#.#.#.#.###.#.#.#.#.#.#.#####################.###############
#...###.....#.#...#...#...#.#.....#.......#.#...#...#...#...#...#...#.#.#.....#.#.#...#.....#...#.#...#.#.......#.....#.......#.........#...#
###########.#.#####.#.#.###.#######.#####.#.#.#.###.#.#.#.#.#.#####.#.#.#.#####.#.###############.#####.#.#####.#.###.#.#######.#######.#.#.#
#...........#...###.#.#.....#.......#...#...#.#...#...#...#...#.....#...#.....#.#.....###...#...#.....#...#...#...###.#.......#.#.......#.#.#
#.#############.###.#.#######.#######.#.#####.###.#############.#############.#.#####.###.#.#.#.#####.#####.#.#######.#######.#.#.#######.#.#
#.......#.....#.....#.###...#.........#...#...#...###.........#.....#...#.....#.....#.#...#...#...###.......#.......#.#.....#...#.....#...#.#
#######.#.###.#######.###.#.#############.#.###.#####.#######.#####.#.#.#.#########.#.#.#########.#################.#.#.###.#########.#.###.#
#.....#...#...#.....#.....#.###...#...#...#.#...#####...#.....#...#.#.#...###.....#.#.#.........#...................#...###...........#.#...#
#.###.#####.###.###.#######.###.#.#.#.#.###.#.#########.#.#####.#.#.#.#######.###.#.#.#########.#######################################.#.###
#...#.......#...###...#...#.....#...#...#...#...#####...#...###.#.#.#...#...#...#...#.###...###...................#.....#...#.......###.#...#
###.#########.#######.#.#.###############.#####.#####.#####.###.#.#.###.#.#.###.#####.###.#.#####################.#.###.#.#.#.#####.###.###.#
###.....#.....###...#...#...............#...#...#####.#.....#...#.#...#.#.#.###.....#...#.#.#.....................#.#...#.#...#.....#...#...#
#######.#.#######.#.###################.###.#.#######.#.#####.###.###.#.#.#.#######.###.#.#.#.#####################.#.###.#####.#####.###.###
#.......#.#.......#.###...#...#...#...#.....#...#####E#...#...#...###.#.#.#.....###.#...#.#.#.....#...#.............#...#.#.....#...#...#.###
#.#######.#.#######.###.#.#.#.#.#.#.#.#########.#########.#.###.#####.#.#.#####.###.#.###.#.#####.#.#.#.###############.#.#.#####.#.###.#.###
#.........#.......#.....#...#.#.#.#.#...........#######...#.#...#.....#.#.#.....#...#.....#.#.....#.#.#.#.....#.......#...#.......#.....#...#
#################.###########.#.#.#.###################.###.#.###.#####.#.#.#####.#########.#.#####.#.#.#.###.#.#####.#####################.#
#...#...#.........#...#.....#...#.#.......###...#######.#...#...#.....#.#.#.#...#.....#...#.#.......#...#.###.#.....#...#.........#.....#...#
#.#.#.#.#.#########.#.#.###.#####.#######.###.#.#######.#.#####.#####.#.#.#.#.#.#####.#.#.#.#############.###.#####.###.#.#######.#.###.#.###
#.#...#...#...#...#.#...#...#...#.........#...#.#######.#.#...#.#.....#...#...#.#...#...#.#...#.......###...#.#...#...#.#.......#...###...###
#.#########.#.#.#.#.#####.###.#.###########.###.#######.#.#.#.#.#.#############.#.#.#####.###.#.#####.#####.#.#.#.###.#.#######.#############
#.#...#...#.#.#.#.#.###...#...#.....#.......#...#######.#.#.#...#.......#.......#.#.###...#...#.#...#.......#...#.....#.#.......#.......#...#
#.#.#.#.#.#.#.#.#.#.###.###.#######.#.#######.#########.#.#.###########.#.#######.#.###.###.###.#.#.###################.#.#######.#####.#.#.#
#.#.#.#.#...#...#...#...#...#.....#.#.#.....#...#######.#.#...#.....#...#...#.....#.#...#...###.#.#.............###...#...###.....#...#...#.#
#.#.#.#.#############.###.###.###.#.#.#.###.###.#######.#.###.#.###.#.#####.#.#####.#.###.#####.#.#############.###.#.#######.#####.#.#####.#
#.#.#.#.#.......#...#.....###...#...#.#.###.....#####...#.#...#...#.#...#...#.....#.#...#.#...#...#...###.....#...#.#.......#.#.....#.......#
#.#.#.#.#.#####.#.#.###########.#####.#.#############.###.#.#####.#.###.#.#######.#.###.#.#.#.#####.#.###.###.###.#.#######.#.#.#############
#.#.#.#.#.#...#...#.........#...#.....#.#############.#...#...#...#...#.#...#...#.#...#.#.#.#...#...#.....###...#...#.....#...#.............#
#.#.#.#.#.#.#.#############.#.###.#####.#############.#.#####.#.#####.#.###.#.#.#.###.#.#.#.###.#.#############.#####.###.#################.#
#.#.#...#...#...#...#.....#...#...#.....#S###########...#...#.#.###...#.#...#.#...###.#.#...#...#.............#...#...###.....#...#...#.....#
#.#.###########.#.#.#.###.#####.###.#####.###############.#.#.#.###.###.#.###.#######.#.#####.###############.###.#.#########.#.#.#.#.#.#####
#...###.........#.#.#...#...#...###.....#.......#####.....#...#...#.....#.#...#.......#...###.#...#.....#.....###.#.........#.#.#...#.#.....#
#######.#########.#.###.###.#.#########.#######.#####.###########.#######.#.###.#########.###.#.#.#.###.#.#######.#########.#.#.#####.#####.#
###.....#.........#...#.#...#.....#.....#.......#####.#.....#...#...#.....#...#...#.....#.#...#.#.#...#.#.......#.#...#.....#.#.....#.#.....#
###.#####.###########.#.#.#######.#.#####.###########.#.###.#.#.###.#.#######.###.#.###.#.#.###.#.###.#.#######.#.#.#.#.#####.#####.#.#.#####
#...#...#.#...###...#.#.#.....#...#.....#.....#...###...#...#.#.#...#.#...#...#...#...#.#.#...#.#...#.#.#...#...#...#.#.....#...#...#.#...###
#.###.#.#.#.#.###.#.#.#.#####.#.#######.#####.#.#.#######.###.#.#.###.#.#.#.###.#####.#.#.###.#.###.#.#.#.#.#.#######.#####.###.#.###.###.###
#.....#...#.#...#.#...#.#.....#.#...#...#...#...#.......#.....#.#...#.#.#.#.#...#...#.#...#...#.#...#.#.#.#.#.......#.#...#...#.#...#...#...#
###########.###.#.#####.#.#####.#.#.#.###.#.###########.#######.###.#.#.#.#.#.###.#.#.#####.###.#.###.#.#.#.#######.#.#.#.###.#.###.###.###.#
#...#.....#.#...#.....#.#.......#.#...#...#.#...#.......#...#...#...#.#.#.#.#.#...#...###...#...#...#.#...#.#...#...#...#.#...#.....#...#...#
#.#.#.###.#.#.#######.#.#########.#####.###.#.#.#.#######.#.#.###.###.#.#.#.#.#.#########.###.#####.#.#####.#.#.#.#######.#.#########.###.###
#.#.#...#...#.........#.###.......#...#...#.#.#...###...#.#...#...###...#.#.#...#.........#...#...#.#...#...#.#.#.....#...#.#.........#...###
#.#.###.###############.###.#######.#.###.#.#.#######.#.#.#####.#########.#.#####.#########.###.#.#.###.#.###.#.#####.#.###.#.#########.#####
#.#.###...#...#...#...#...#.....#...#.#...#.#.#.......#...#...#.......###...###...#.....#...#...#...#...#.#...#.#.....#.....#.......#...#...#
#.#.#####.#.#.#.#.#.#.###.#####.#.###.#.###.#.#.###########.#.#######.#########.###.###.#.###.#######.###.#.###.#.#################.#.###.#.#
#.#.......#.#.#.#...#.#...###...#...#...#...#.#...#.......#.#...#.....#.........#...#...#...#.#...#...#...#...#.#...............###...###.#.#
#.#########.#.#.#####.#.#####.#####.#####.###.###.#.#####.#.###.#.#####.#########.###.#####.#.#.#.#.###.#####.#.###############.#########.#.#
#.#.....#...#...###...#.###...#...#.#.....#...#...#.#.....#.#...#.....#...#...#...#...#...#.#...#.#...#...#...#...#...........#.....#...#.#.#
#.#.###.#.#########.###.###.###.#.#.#.#####.###.###.#.#####.#.#######.###.#.#.#.###.###.#.#.#####.###.###.#.#####.#.#########.#####.#.#.#.#.#
#.#.###.#.#...#...#...#...#.#...#...#.#...#.###...#.#...#...#...#...#...#.#.#.#.#...#...#.#...#...#...###.#.....#.#.........#.#...#...#...#.#
#.#.###.#.#.#.#.#.###.###.#.#.#######.#.#.#.#####.#.###.#.#####.#.#.###.#.#.#.#.#.###.###.###.#.###.#####.#####.#.#########.#.#.#.#########.#
#.#.#...#...#.#.#.....#...#...#.......#.#.#...###...#...#...#...#.#.#...#.#.#.#.#...#.###.#...#...#.....#.#.....#...........#...#.......#...#
#.#.#.#######.#.#######.#######.#######.#.###.#######.#####.#.###.#.#.###.#.#.#.###.#.###.#.#####.#####.#.#.###########################.#.###
#...#.....#...#.#.....#.###.....#...#...#...#.....###...#...#...#.#.#.#...#.#...###.#.#...#.#...#.#.....#...#.........................#.#...#
#########.#.###.#.###.#.###.#####.#.#.#####.#####.#####.#.#####.#.#.#.#.###.#######.#.#.###.#.#.#.#.#########.#######################.#.###.#
#.........#...#...#...#...#...#...#.#.....#.....#.#.....#.#.....#.#.#.#...#.#.......#.#...#.#.#...#.....#.....#.........#.............#.....#
#.###########.#####.#####.###.#.###.#####.#####.#.#.#####.#.#####.#.#.###.#.#.#######.###.#.#.#########.#.#####.#######.#.###################
#.......#.....#.....#...#...#.#.#...#.....#.....#.#...#...#.#...#.#.#.#...#.#.#...#...#...#.#.....#.....#.#.....###...#.#...................#
#######.#.#####.#####.#.###.#.#.#.###.#####.#####.###.#.###.#.#.#.#.#.#.###.#.#.#.#.###.###.#####.#.#####.#.#######.#.#.###################.#
#.......#.....#.#...#.#.#...#.#.#...#.....#.#...#.#...#.#...#.#.#.#.#.#...#.#.#.#.#...#...#.#.....#.......#.........#.#.#...#...#...#...#...#
#.###########.#.#.#.#.#.#.###.#.###.#####.#.#.#.#.#.###.#.###.#.#.#.#.###.#.#.#.#.###.###.#.#.#######################.#.#.#.#.#.#.#.#.#.#.###
#.............#...#...#...###...###.......#...#...#.....#.....#...#...###...#...#.....###...#.........................#...#...#...#...#...###
##############################################################################################################################################"""

map = aoc.DM2(inp)
start = map.Find("S")
end = map.Find("E")

res, path = map.FindPath(start, end, False)

og = len(path) - 1

remaining = {}

for i in range(len(path)):
    pos = path[i]
    remaining[pos] = len(path) - i - 1 

results = {}

def TryCheat(cheatStart, cheatEnd, cheatLen):
    if cheatEnd not in remaining:
       return

    rem = remaining[cheatStart]    
    cand = remaining[cheatEnd] + cheatLen

    if cand < rem:
        delta = rem - cand
        if delta not in results:
            results[delta] = 0
        results[delta] += 1

maxCheat = 20
legalOffsets = []

for y in range(-maxCheat, maxCheat + 1):
    for x in range(-maxCheat, maxCheat + 1):
        cheatLen = abs(x) + abs(y)
        if cheatLen <= maxCheat and cheatLen > 1:
            legalOffsets.append((x, y, cheatLen))

for i in range(len(path) - 1):
    cell = path[i]

    for (x, y, cheatLen) in legalOffsets:
        cheatEnd = (cell[0] + x, cell[1] + y)

        if map.IsValidIndex(*cheatEnd):
            TryCheat(cell, cheatEnd, cheatLen)

sum = 0
for key in results.keys():
    if key >= 100:
        sum += results[key]
print(sum)